(function(m){var l=window.AmazonUIPageJS||window.P,r=l._namespace||l.attributeErrors,e=r?r("DetailPageTwisterViewAsset"):l;e.guardFatal?e.guardFatal(m)(e,window):e.execute(function(){m(e,window)})})(function(m,l,r){m.when("A","dp-refresh-handler","view-util","twister-string-constants").register("page-refresh-view",function(e,h,g,d){var a=e.$;return function(c,k,f){function b(b){return{chunk:function(b){var f=b.ASIN,c=b.Value;b=b.FeatureName;if(!t.hiddenFeatures[b]){var d,e;try{b&&c&&c.content&&(e=
c.content[b],"undefined"!==typeof e&&(d=a("#"+b),d.html(e),d.css({opacity:""})))}catch(q){b=b||"NoFeatureName",z.logFatal(q,{message:"Error in feature"+b})}t.twisterRefreshHandler.stampFeature(b,f)}},success:function(b,a,f){F("twisterUpdateSuccess")},error:function(b,a,f){Twister.$("#variations-overlay").hide();F("twisterUpdateFailure");Twister.showErrorMessageOnFailure&&(alert(Twister.errorMessageOnFailure),location.reload())},abort:function(b){z.logFatal("Ajax aborted: "+b)},timeout:4E4}}function p(b,
a,f,c,d){var e={},q=[];"parent"===b?(e=x(a,c,"parent",d),q.parent=e,e=x(f,c,"partial",d),q.partial=e):(e=x(f,c,b,d),q[b]=e);return q}function q(b,f,c,d,e){for(var q in b)if(b.hasOwnProperty(q)){if("full"===q){var k=c.dimensionType,p=t.twisterUtil.getDimensionInfo().length;t.twisterRefreshHandler.startMeasurement(c.newAsin,k,p,c.dimensionDisplayType)}k=b[q].twisterRefreshParams;p=b[q].notifyClientParams;e&&(a(t.config[q].affectedFeatures).css({opacity:.5}),t.twisterRefreshHandler.doPageRefresh(null,
k,f,d));C(p.asin,p.id,q,e)}}function w(){a.each(k.contextMetaData,function(b,f){var c={},d=f.elementList||[],e=d.length,q=[];c.click={};c.mouseOver={};for(var k=0;k<e;k++){var p=a("#"+d[k].divToUpdate);q.push("#"+d[k].divToUpdate);p.length&&d[k].customClientFunction&&(d[k].updateOnHover&&(c.mouseOver[d[k].divToUpdate]=p.attr("customfunctionname")),c.click[d[k].divToUpdate]=p.attr("customfunctionname"))}t.config[b].affectedFeatures=q.join(",");t.config[b].clientFeatures=c})}function C(b,f,c,e){var q=
"",q=e?d.EVENT_TYPE_CLICK:d.EVENT_TYPE_MOUSEOVER;a.each(t.config[c].clientFeatures[q],function(a,c){try{var d=function(){t.twisterRefreshHandler.stampImageLoad(b)};(function(){var b={};b.P=m;(function(){eval("var P = this.P;");var b=r,b=eval("0, "+c);b(f,DetailPage.StateController,d)}).call(b)})()}catch(e){z.logFatal("Client feature - "+a+", threw and exception :- "+e)}})}function x(b,a,f,c){var d={},q={};d.asinList=b;d.id="parent"===f?b:"partial"===c?a:b;d.mType=f;d=u(f,d);f=!1;(c=e.state("pwState"))&&
(f=c.isTryState);f&&(d.isTryState=f);d=t.twisterRefreshHandler.createCustomParamsMap({},d);q.asin=b;q.id=a;return{twisterRefreshParams:d,notifyClientParams:q}}function u(b,f){a.each(k.contextMetaData[b].mTypeSpecificURLParams,function(b,a){f[b]=a});return f}function D(b){b=t.twisterUtil.getSelectionInfoFromSelectedVariationValuesMap(b.selected_variation_values);t.twisterUtil.isFullySelected(b)?t.currentPageSelectionState="full":t.currentPageSelectionState="partial"}function A(b){var a={};b=b.twisterUpdateURLInfo.immutableURLPrefix;
b+="&isFlushing=2&dpEnvironment="+Twister.dpEnvironment;a.pageRefreshUrl=b;return a}function v(b){var a={};a.config=b.measurement;a.dimensionDisplayType=b.dimensionsDisplayType;a.storeID=b.storeID;a.productGroupID=b.productGroupID;return a}function y(b,a){var f;"partial"===b&&"partial"===a&&(f="partial");"partial"===b&&"full"===a&&(f="full");"full"===b&&"partial"===a&&(f="parent");"full"===b&&"full"===a&&(f="full");return f}var t=this,B=k.parent_asin,n=l.ue,G="",z=new f("dpTwisterPageRefreshView");
this.twisterUtil=c.util;this.twisterFeatureName="Twister";this.currentPageSelectionState;this.twisterRefreshHandler;this.config={partial:{},full:{},parent:{},master:{}};this.hiddenFeatures={intermediateEOS:1,EOS:1};t.viewUtil=new g(c);t.subType;var F=function(b){n&&n.count&&n.count(b,(n.count(b)||0)+1)};(function(){D(k);w();var a={featureName:t.twisterFeatureName},f=A(k),e=v(k);t.twisterRefreshHandler=new h(a,f,e);c.registerPassive({viewAttribution:"DetailPage",viewName:"WebTwisterRefreshView"},{updateView:function(a,
f){var c={};if(a!==d.METADATA){var c={},e;e=r;if(f)switch(a){case d.VARIATION_CHANGE:e=f.selected().selInfo;break;case d.VARIATION_PEEK:e=f.peek().selInfo}c.selectionInfo=e;c.dimensionCombination=t.viewUtil.getCurrDimCombId(c.selectionInfo,"_","X");e=t.twisterUtil.isFullySelected(c.dimensionCombination);c.childAsin=t.twisterUtil.getAsinFromSelectionInfo(c.selectionInfo,e);c.newPageSelectionState=e?"full":"partial";c.mTypeForRefresh=y(t.currentPageSelectionState,c.newPageSelectionState);c.newAsin=
"parent"===c.mTypeForRefresh?B:c.childAsin;c.doNotAbort="parent"===c.mTypeForRefresh?!0:!1;c.twisterCallListParams=p(c.mTypeForRefresh,c.newAsin,c.childAsin,c.dimensionCombination,c.newPageSelectionState);c.optionsForTwisterRefresh=b(f);c.pageRefreshMeasure={newAsin:c.newAsin,dimensionType:G,dimensionDisplayType:k.dimensionsDisplayType}}switch(a){case d.VARIATION_CHANGE:t.subType!==d.PRODUCTIZED_VIEW_SUBTYPE&&(q(c.twisterCallListParams,c.optionsForTwisterRefresh,c.pageRefreshMeasure,c.doNotAbort,
!0),t.currentPageSelectionState=c.newPageSelectionState,t.subType=r);break;case d.VARIATION_PEEK:q(c.twisterCallListParams,c.optionsForTwisterRefresh,c.pageRefreshMeasure,c.doNotAbort,!1);break;case d.METADATA:switch(f.subType){case d.DP_STATE_VIEW_SUBTYPE:G=f.divMetadata.dimDisplayType;break;case d.PRODUCTIZED_VIEW_SUBTYPE:t.subType=f.subType,c.dimensionCombination=f.newDimCombID,c.childAsin=f.childAsin,c.newAsin=f.newAsin,c.newPageSelectionState=t.twisterUtil.isFullySelected(c.dimensionCombination)?
"full":"partial",c.mTypeForRefresh=y(t.currentPageSelectionState,c.newPageSelectionState),c.doNotAbort="parent"===c.mTypeForRefresh?!0:!1,c.twisterCallListParams=p(c.mTypeForRefresh,c.newAsin,c.childAsin,c.dimensionCombination,c.newPageSelectionState),c.optionsForTwisterRefresh=b(f),c.pageRefreshMeasure={newAsin:c.newAsin,dimensionType:f.divMetaData?f.divMetaData.dimDisplayType:r,dimensionDisplayType:k.dimensionsDisplayType},q(c.twisterCallListParams,c.optionsForTwisterRefresh,c.pageRefreshMeasure,
c.doNotAbort,!0),t.currentPageSelectionState=c.newPageSelectionState}}}})})()}});m.when("A","twister-util","ready").execute(function(e,h){var g=l.ue;if(e.state("dimensionKeyList")!==r)for(var d in e.state("dimensionKeyList").dimensionKeys)d!==r&&(e.on("a:popover:beforeShow:mobile-twister_"+d,function(a){e.state("twisterInteractability")===r&&g&&"function"===typeof g.count&&g.count("Twister:blankTwisterSecView",(g.count("Twister:blankTwisterSecView")||0)+1)}),e.on("a:popover:beforeHide:mobile-twister_"+
d,function(a){if(a&&a.popover){a=a.popover.getContent();var c=0<a.find(".aw-twister-row:first").length;a&&!c&&g&&"function"===typeof g.count&&g.count("blankTwisterSecondaryView",(g.count("blankTwisterSecondaryView")||0)+1)}}))});m.when("A").register("twister-bottom-sheet-container",function(e){return{getInstance:function(){return this.sheetViewInstance},saveInstance:function(h){this.sheetViewInstance=h;e.trigger("dp:sheet:twister:initialized")}}})});